// var memory_array = ['A','A','B','B','C','C','D','D','E','E','F','F','G','G','H','H','I','I','J','J','K','K','L','L'];
var memory_array_men = [
	{
		"title": "James Baldwin",
		"image": "./images/jamesbaldwin.jpg",
		"cardFront": "./images/card-front.jpg",
		"bio": "James Baldwin was an American writer and social critic. His essays, as collected in Notes of a Native Son, explore palpable yet unspoken intricacies of racial, sexual, and class distinctions in Western societies, most notably in mid-20th-century America.",
		"link": "https://en.wikipedia.org/wiki/James_Baldwin"
	},
	{
		"title": "James Baldwin",
		"image": "./images/jamesbaldwin.jpg",
		"cardFront": "./images/card-front.jpg",
		"bio": "James Baldwin was an American writer and social critic. His essays, as collected in Notes of a Native Son, explore palpable yet unspoken intricacies of racial, sexual, and class distinctions in Western societies, most notably in mid-20th-century America.",
		"link": "https://en.wikipedia.org/wiki/James_Baldwin"
	},
	{
		"title": "Langston Hughes",
		"image": "./images/langstonhughes.jpg",
		"cardFront": "./images/card-front.jpg",
		"bio": "Langston Hughes was an important figure in the Harlem Renaissance and made the African American experience the subject of his writings, which ranged from poetry and plays to novels and newspaper columns.",
		"link": "https://en.wikipedia.org/wiki/Langston_Hughes"
	},
	{
		"title": "Langston Hughes",
		"image": "./images/langstonhughes.jpg",
		"cardFront": "./images/card-front.jpg",
		"bio": "Langston Hughes was an important figure in the Harlem Renaissance and made the African American experience the subject of his writings, which ranged from poetry and plays to novels and newspaper columns.",
		"link": "https://en.wikipedia.org/wiki/Langston_Hughes"
	},
	{
		"title": "Jack Johnson",
		"image": "./images/jackjohnson.jpg",
		"cardFront": "./images/card-front.jpg",
		"bio": "John Johnson became the first African American world heavyweight boxing champion.",
		"link": "https://en.wikipedia.org/wiki/Jack_Johnson_(boxer)"
	},
	{
		"title": "Jack Johnson",
		"image": "./images/jackjohnson.jpg",
		"cardFront": "./images/card-front.jpg",
		"bio": "John Johnson became the first African American world heavyweight boxing champion.",
		"link": "https://en.wikipedia.org/wiki/Jack_Johnson_(boxer)"
	},
	{
		"title": "W.E.B. Dubois",
		"image": "./images/webdubois.jpg",
		"cardFront": "./images/card-front.jpg",
		"bio": "W. E. B. Du Bois was an American sociologist, historian, civil rights activist, Pan-Africanist, author, writer and editor.",
		"link": "https://en.wikipedia.org/wiki/W._E._B._Du_Bois"
	},
	{
		"title": "W.E.B. Dubois",
		"image": "./images/webdubois.jpg",
		"cardFront": "./images/card-front.jpg",
		"bio": "W. E. B. Du Bois was an American sociologist, historian, civil rights activist, Pan-Africanist, author, writer and editor.",
		"link": "https://en.wikipedia.org/wiki/W._E._B._Du_Bois"
	},
	{
		"title": "Toussaint L\\'Ouverture",
		"image": "./images/toussaintlouverture.jpg",
		"cardFront": "./images/card-front.jpg",
		"bio": "François-Dominique Toussaint Louverture, also known as Toussaint L'Ouverture was the best-known leader of the Haitian Revolution.",
		"link": "https://en.wikipedia.org/wiki/Toussaint_Louverture"
	},
	{
		"title": "Toussaint L\\'Ouverture",
		"image": "./images/toussaintlouverture.jpg",
		"cardFront": "./images/card-front.jpg",
		"bio": "François-Dominique Toussaint Louverture, also known as Toussaint L'Ouverture was the best-known leader of the Haitian Revolution.",
		"link": "https://en.wikipedia.org/wiki/Toussaint_Louverture"
	},
	{
		"title": "Benjamin Banneker",
		"image": "./images/benjaminbanneker.jpg",
		"cardFront": "./images/card-front.jpg",
		"bio": "Benjamin Banneker was an almanac author, surveyor, naturalist, and farmer.",
		"link": "https://en.wikipedia.org/wiki/Benjamin_Banneker"
	},
	{
		"title": "Benjamin Banneker",
		"image": "./images/benjaminbanneker.jpg",
		"cardFront": "./images/card-front.jpg",
		"bio": "Benjamin Banneker was an almanac author, surveyor, naturalist, and farmer.",
		"link": "https://en.wikipedia.org/wiki/Benjamin_Banneker"
	},
]

var memory_array_men2 = [
	
	{
		"title": "Marcus Garvey",
		"image": "./images/marcusgarvey.jpg",
		"cardFront": "./images/card-front.jpg"
	},
	{
		"title": "Marcus Garvey",
		"image": "./images/marcusgarvey.jpg",
		"cardFront": "./images/card-front.jpg"
	},
	{
		"title": "Robert Smalls",
		"image": "./images/robertsmalls.jpg",
		"cardFront": "./images/card-front.jpg"
	},
	{
		"title": "Robert Smalls",
		"image": "./images/robertsmalls.jpg",
		"cardFront": "./images/card-front.jpg"
	},
	{
		"title": "George Washington Carver",
		"image": "./images/georgewashintoncarver.jpg",
		"cardFront": "./images/card-front.jpg"
	},
	{
		"title": "George Washington Carver",
		"image": "./images/georgewashintoncarver.jpg",
		"cardFront": "./images/card-front.jpg"
	},
	{
		"title": "Frederick Douglass",
		"image": "./images/frederickdouglass.jpg",
		"cardFront": "./images/card-front.jpg"
	},
	{
		"title": "Frederick Douglass",
		"image": "./images/frederickdouglass.jpg",
		"cardFront": "./images/card-front.jpg"
	},
	{
		"title": "Crispus Attucks",
		"image": "./images/crispusattucks.jpg",
		"cardFront": "./images/card-front.jpg"
	},
	{
		"title": "Crispus Attucks",
		"image": "./images/crispusattucks.jpg",
		"cardFront": "./images/card-front.jpg"
	},
	{
		"title": "Carter G Woodson",
		"image": "./images/cartergwoodson.jpg",
		"cardFront": "./images/card-front.jpg"
	},
	{
		"title": "Carter G Woodson",
		"image": "./images/cartergwoodson.jpg",
		"cardFront": "./images/card-front.jpg"
	},
]
var memory_array_women = [
	{
		"title": "Madam CJ Walker",
		"image": "./images/madamcjwalker.jpg",
		"cardFront": "./images/card-front.jpg"
	},
	{
		"title": "Madam CJ Walker",
		"image": "./images/madamcjwalker.jpg",
		"cardFront": "./images/card-front.jpg"
	},
	{
		"title": "Sojouner Truth",
		"image": "./images/sojournertruth.jpg",
		"cardFront": "./images/card-front.jpg"
	},
	{
		"title": "Sojouner Truth",
		"image": "./images/sojournertruth.jpg",
		"cardFront": "./images/card-front.jpg"
	},
	{
		"title": "Mary Ann Shadd Cary",
		"image": "./images/maryannshaddcary.jpg",
		"cardFront": "./images/card-front.jpg"
	},
	{
		"title": "Mary Ann Shadd Cary",
		"image": "./images/maryannshaddcary.jpg",
		"cardFront": "./images/card-front.jpg"
	},
	{
		"title": "Zora Neal Hurston",
		"image": "./images/zoranealhurston.jpg",
		"cardFront": "./images/card-front.jpg"
	},
	{
		"title": "Zora Neal Hurston",
		"image": "./images/zoranealhurston.jpg",
		"cardFront": "./images/card-front.jpg"
	},
	{
		"title": "Shirley Chisholm",
		"image": "./images/shirleychisholm.jpg",
		"cardFront": "./images/card-front.jpg"
	},
	{
		"title": "Shirley Chisholm",
		"image": "./images/shirleychisholm.jpg",
		"cardFront": "./images/card-front.jpg"
	},
	{
		"title": "Bessie Coleman",
		"image": "./images/bessiecoleman.jpg",
		"cardFront": "./images/card-front.jpg"
	},
	{
		"title": "Bessie Coleman",
		"image": "./images/bessiecoleman.jpg",
		"cardFront": "./images/card-front.jpg"
	}
];

var memory_array_women2 = [
	
	{
		"title": "Kathleen Cleaver",
		"cardFront": "./images/card-front.jpg",
		"image": "./images/kathleencleaver.jpg"
	},
	{
		"title": "Kathleen Cleaver",
		"cardFront": "./images/card-front.jpg",
		"image": "./images/kathleencleaver.jpg"
	},
	{
		"title": "Angela Davis",
		"cardFront": "./images/card-front.jpg",
		"image": "./images/angeladavis.jpg"
	},
	{
		"title": "Angela Davis",
		"cardFront": "./images/card-front.jpg",
		"image": "./images/angeladavis.jpg"
	},
	{
		"title": "Katherine Johnson",
		"cardFront": "./images/card-front.jpg",
		"image": "./images/katherinejohnson.jpg"
	},
	{
		"title": "Katherine Johnson",
		"cardFront": "./images/card-front.jpg",
		"image": "./images/katherinejohnson.jpg"
	},
	{
		"title": "Henrietta Lacks",
		"cardFront": "./images/card-front.jpg",
		"image": "./images/henriettalacks.jpg"
	},
	{
		"title": "Henrietta Lacks",
		"cardFront": "./images/card-front.jpg",
		"image": "./images/henriettalacks.jpg"
	},
	{
		"title": "Harriet Tubman",
		"cardFront": "./images/card-front.jpg",
		"image": "./images/harriettubman.jpg"
	},
	{
		"title": "Harriet Tubman",
		"cardFront": "./images/card-front.jpg",
		"image": "./images/harriettubman.jpg"
	},
	{
		"title": "Ida B Wells",
		"cardFront": "./images/card-front.jpg",
		"image": "./images/idabwells.jpg"
	},
	{
		"title": "Ida B Wells",
		"cardFront": "./images/card-front.jpg",
		"image": "./images/idabwells.jpg"
	}
]


var memory_values = [];
var memory_tile_ids = [];
var tiles_flipped = 0;

var card_array = [memory_array_men, memory_array_men2, memory_array_women, memory_array_women2];

card_array = _.shuffle(card_array);
var memory_array = card_array[0]


function newBoard() {
	tiles_flipped = 0;
  memory_array = _.shuffle(memory_array);

  var output = '';
  _.each(memory_array, function(memory_array_value, index) {
    output += '<div id="tile_'+ index +'" data-cardFront='+ memory_array_value.cardFront + ' data-img='+ memory_array_value.image + '  data-link='+ memory_array_value.link + ' data-bio="'+ memory_array_value.bio +'"  onclick="memoryFlipTile(this,\''+ memory_array_value.title +'\')" class="card"></div>';
    
    var cardFront = output[index];
  });

	document.getElementById('memory_board').innerHTML = output;
	var cardFront = document.getElementsByClassName('card')
	_.each(cardFront, function(value_cardFront, index_cardFront){
		var cardFrontImage = value_cardFront.getAttribute('data-cardFront')
		value_cardFront.style.backgroundImage = "url('"+ cardFrontImage+"')"

	})
	// console.log(cardFront);
}

function ready(fn) {
	  if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading"){
	    fn();
	  } else {
	    document.addEventListener('DOMContentLoaded', fn);
	  }
	}

ready(function(){
	var startGame = function(){
	// console.log(document.getElementsByClassName('start_button'))
	var start_button = document.getElementsByClassName('start_button')[0]
	// start_button.removeEventListener('click', function(){});
	start_button.addEventListener('click', function(e){
		e.preventDefault();
		document.querySelector('.game_intro').classList.add('slide_up');
		document.querySelector('.game_wrapper').classList.remove('displayNone');
		newBoard();
	})

}

startGame()
})


function canFlipCard(tile) {
  return tile.innerHTML == "" && memory_values.length < 2;
}

function isOneCardFlipped() {
  return memory_values.length == 1
}

function areNoCardsFlipped() {
  return memory_values.length == 0;
}

function setCardAsFlipped(tile, value) {
  memory_values.push(value);
  memory_tile_ids.push(tile.id);
}

function isThereIsAMatch() {
  return memory_values[0] == memory_values[1];
}

function matchCards(tile, value) {
  tiles_flipped += 2;
  // Clear both arrays
  memory_values = [];
  memory_tile_ids = [];
  showBio(tile, value);
}

function showBio(tile, value){
	setTimeout(function(){
		document.querySelector('.bio').textContent = "";
		document.querySelector('.bio_wrapper').classList.remove('displayNone');
		document.querySelector('.bio').textContent = tile.getAttribute('data-bio');
		document.querySelector('.learn_more').setAttribute('href', tile.getAttribute('data-link'))
	}, 500);
	

	closeBio();
}

function closeBio(){
	document.querySelector('.close').addEventListener('click', function(e){
		document.querySelector('.bio_wrapper').classList.add('displayNone');
		var cards = document.getElementsByClassName('card');
		for(var i = 0; i < cards.length; i++){
			if(tiles_flipped == memory_array.length ){
				isGameOver(true);
			} else {
				isGameOver(false);
			}

		}		

	});

}



function isGameOver(check) {
  // Check to see if the whole board is cleared
  if (check == true) {
  	gameIsOver();

  } else {
  	return false
  }
  // var bio_wrapper = document.querySelector('.bio_wrapper');
  // // var cards = document.getElementsByClassName('card')
  // // for(var i = 0; i < cards.length; i++){
  // // 	if(cards[i].classList.contains('flipped') && tiles_flipped == memory_array.length ){
  // 		if(bio_wrapper.classList.contains('displayNone')){
  // 			if (tiles_flipped == memory_array.length) {
  // 				return true;	
  // 			}
  			
  // 		}
  // // 	}
  // // }
  
}

function startNewGame(){
	
	console.log("sng")
	document.querySelector('.play_again').addEventListener('click', function(e){
		e.preventDefault();
		console.log("clicked")
		document.getElementById('memory_board').innerHTML = "";

		document.getElementsByClassName('you_win')[0].classList.add('displayNone');
		newBoard();

	})
	newBoard();
}

function gameIsOver() {
  // alert("Board cleared... generating new board");
  // var play_again = confirm ("You Won Play Again?")
  var you_win = document.getElementsByClassName('you_win');
  console.log(you_win[0].classList.remove('displayNone'))
  
  startNewGame();
}

function cardsDoNotMatch() {
  setTimeout(flipCardBack, 700);
}

function flipCard(tile, value) {
	
	var image = tile.getAttribute('data-img')
	var text_elem = document.createElement('span');
	text_elem.textContent = value;

  // tile.style.background = '#FFF';
  tile.style.backgroundImage = "url('"+ image+"')";
  // tile.innerHTML = value;
  tile.classList.add('flipped');
  tile.appendChild(text_elem)
  

}

function flipCardBack(tile, value) {
  // Flip the 2 tiles back over
  var tile_1 = document.getElementById(memory_tile_ids[0]);
  var tile_2 = document.getElementById(memory_tile_ids[1]);

  var cardFrontImage = tile_1.getAttribute('data-cardFront')  

  tile_1.style.backgroundImage = "url('"+ cardFrontImage +"')"
  tile_1.innerHTML = "";
  tile_2.style.backgroundImage = "url('"+ cardFrontImage +"')"
  tile_2.innerHTML = "";
  tile_1.classList.remove('flipped');
  tile_2.classList.remove('flipped');

  // Clear both arrays
  memory_values = [];
  memory_tile_ids = [];
}

function memoryFlipTile(tile, value, image) {

	if (canFlipCard(tile)) {
		flipCard(tile, value);
    if (areNoCardsFlipped()) {
			setCardAsFlipped(tile, value);
		} else if(isOneCardFlipped()) {
      setCardAsFlipped(tile, value);
      if(isThereIsAMatch()) {
        matchCards(tile, value);

      } else {
  			cardsDoNotMatch();
      }
    }
  }
}
